{% extends "util/base.njk" %}

{% block script %}
    <script src="/socket.io/socket.io.js" defer></script>
    <script src="/js/meeting.js" type="module" defer></script>
{% endblock script %}

{% block navbar %}
{% endblock navbar %}

{% block prefab %}
    <div class="cam">
        <video class="cam__video" autoplay playsinline control=false></video>
        <img class="cam__profile" src="/imgs/dummy_profile.png" alt="profile_picture">
        <div class="cam__menu">
            <button class="cam__pin-btn" data-tooltip="釘選"><i class='bx bx-pin'></i></button>
        </div>
        <span class="cam__name"></span>
        <span class="cam__warning" hidden>!</span>
    </div>
    <li class="msg">
        <p>
            <span class="msg__user"></span>
            <span class="msg__timestamp"></span>
        </p>
        <div class="msg__date" data-content-after=":after">
            <p class="msg__text" ></p>
        </div>
    </li>
    <li class="my-msg">
        <p>
            <span class="my-msg__timestamp"></span>
            <span class="my-msg__user"></span>
        </p>
        <div class="my-msg__date" data-content-before=":before">
            <p class="my-msg__text" ></p>
        </div>
    </li>
    <li class="notification" data-type="generic">
        <header>
            {% include 'svg/bell.svg' %}
        </header>
        <div class="flex-item-1">
            <h3 class="notification__title">下課提醒</h3>
            <p class="notification__text">現在是下課時間</p>
        </div>
        <footer>
            <button class="notification__close-btn btn-red">{% include 'svg/cross.svg' %}</button>
        </footer>
    </li>

    <div class="alert-setting">
        <div class="alert_icon_buttons" id="alert-return" style="left: 15px;">
            <i class="bx bx-arrow-back"></i>
        </div>
        <div class="container">
            <h1 class="class-modal__title"></h1>
            <fieldset>
                <legend>警醒</legend>
                <div id="error-text" class="error-text"></div>
                <label for="alert-interval">警醒間隔:</label>
                <div class="field">
                    <input id="alert-interval" class="alert-interval" name="alert-interval" type="number" required="" min="10" max="50">
                    <label for="alert-interval">分鐘</label>
                </div>
                <label for="alert-time">警醒持續時間:</label>
                <div class="field">
                    <input id="alert-time" class="alert-time" name="alert-time" type="number" required="" min="1" max="3">
                    <label for="alert-time">分鐘</label>
                </div>
            </fieldset>
            <div class="center-btn">
                <button type="button" id="alert-finish" class="margin-inline-start-auto btn-primary">設定完成</button>
            </div>
        </div>
    </div>


{% endblock prefab %}

{% block content %}

    <div id="meeting-panel" class="close-message">

        <nav class="sidebar close">
            <header>
                <div class="image-text">
                    <span class="image">
                         <img src="/imgs/logo.png" alt="logo">
                    </span>

                    <div class="text header-text">
                        <span class="sidebar__class-name">應用統計學</span>
                        <span class="sidebar__class-id">xxx-xxx</span>
                    </div>
                </div>
            </header>
            <div class="toggle">
                <i class='bx bx-chevron-right'></i>
            </div>

            <div class="menu-bar">
                <div class="menu">
                    <ul class="menu-links">
                        <li class="nav-link">
                            <button class="nav-btn" disabled="disabled">
                                {% include 'svg/setting.svg' %}
                                <span class="text nav-text" style="text-decoration:line-through;color: #818181;">尚無功能</span>
                                {# 裝置設定 #}
                            </button>
                        </li>
                        <li class="nav-link">
                            <button class="nav-btn" disabled="disabled">
                                {% include 'svg/setting.svg' %}
                                <span class="text nav-text" style="text-decoration:line-through;color: #818181;">尚無功能</span>
                                {# 會議選項 #}
                            </button>
                        </li>
                        <li class="nav-link">
                            <button class="nav-btn" disabled="disabled">
                                {% include 'svg/setting.svg' %}
                                <span class="text nav-text" style="text-decoration:line-through;color: #818181;">尚無功能</span>
                                {# 會議資訊 #}
                            </button>
                        </li>
                        <li class="nav-link">
                            <button class="nav-btn">
                                {% include 'svg/setting.svg' %}
                                <span class="text nav-text">警醒資訊</span>
                            </button>
                        </li>
                    </ul>
                </div>

                <div class="bottom-content">
                    <li class="mode">
                        <div class="moon-sun">
                            <i class='bx bx-moon icon moon'></i>
                            <i class='bx bx-sun icon sun'></i>
                        </div>
                        <span class="mode-text text">黑暗模式</span>

                        <div class="toggle-switch">
                        </div>
                    </li>
                </div>
            </div>
        </nav>

        <div class="floating-container">

            <div class="floating">
                <div class="close-floating_button">
                    <i class='bx bx-x-circle'></i>
                </div>

                {% include './sidebar/alert-info.njk' %}

            </div>
        </div>

        <ul id="notification-container">
        </ul>

        <div id="meeting-panel__left">
            <div id="cam-area">
                <div id="pinned-cam-container">

                </div>
                <div id="cam-container">

                </div>
                <div id='alert' hidden>

                </div>

            </div>

            <div id="toolbar">

                <div class="dock">
                    <div class="dock-container">
                        <li class="li-1">
                            <div class="name">麥克風</div>
                            <div class="ico" id="ico"></div>
                        </li>
                        <li class="li-2">
                            <div class="name">視訊</div>
                            <div class="ico" id="ico"></div>
                        </li>
                        <li class="li-3">
                            <div class="name">螢幕分享</div>
                            <div class="ico" id="ico"><button id="screen-share-btn" class="btn-primary btn-round" disabled>{% include './svg/screen_share.svg' %}</button></div>
                        </li>
                        <li class="li-4">
                            <div class="name">下課鈴</div>
                            <div class="ico" id="ico"><button id="notify-dismiss-btn" class="btn-primary btn-round" disabled>{% include './svg/bell.svg' %}</button></div>
                        </li>
                        <li class="li-bin li-5">
                            <div class="name">退出會議</div>
                            <div class="ico" id="ico"><button id="hang-up-btn" class="btn-red btn-round" disabled>{% include './svg/hang_up.svg' %}</button></div>
                        </li>

                    </div>
                </div>

                {# <span id="call-id">{{ callId }}</span> #}
                <input id="call-id" type="text" value="{{ callId }}" hidden>
                {# <input id="call-input" type="text"> #}
                {# <button id="screen-share-btn" class="btn-primary btn-round" disabled>{% include 'svg/screen_share.svg' %}</button>
                <button id="hang-up-btn" class="btn-red btn-round" disabled>{% include 'svg/hang_up.svg' %}</button>
                <button id="message-btn" class="btn-primary btn-round">{% include 'svg/message.svg' %}</button> #}


                <button id="message-btn" class="btn-primary btn-round" data-tooltip="聊天室">{% include './svg/message.svg' %}</button>
            </div>
        </div>

        <div id="meeting-panel__right" class="sidebar-right close">
            {# <header>
                <div class="segmented-control">

                    <input type="radio" name="radio2" value="3" id="tab-1" checked/>
                    <label for="tab-1" class= "segmented-control__1">
                        <p>聊天室</p></label>

                    <input type="radio" name="radio2" value="4" id="tab-2" />
                    <label for="tab-2" class= "segmented-control__2">
                        <p>參與者</p></label>

                    <div class="segmented-control__color"></div>

                </div>
            </header> #}
            <div id="chat">
                <ul id="chat__room" class="margin-block-end-2"></ul>

                <div id="chat__bar">
                    <input
                        id="msg-input"
                        name="msg-input"
                        type="text"
                        placeholder="輸入訊息"
                        autocomplete="off"
                        required
                    />
                    <button id="send-msg-btn" class="btn-primary">{% include 'svg/airplane.svg' %}</button>
                </div>
            </div>
        </div>
    </div>

    <div id="end-panel" class="flex flex-column flex-center gap-2">
        <h1>通話結束</h1>
        <a href="/">返回課程</a>
    </div>

    <div id="confirm-panel" class="flex flex-column flex-center gap-2">
        <div id="confirm-panel__cam-container" class="flex flex-row gap-2"></div>

        <div class="flex flex-row gap-2">
            <button id="mic-btn" class="btn-switch btn-round btn-on" disabled>{% include 'svg/mic.svg' %}{% include 'svg/mic_off.svg' %}</button>
            <button id="webcam-btn" class="btn-switch btn-round" disabled>{% include 'svg/webcam.svg' %}{% include 'svg/webcam_off.svg' %}</button>
            <button id="enter-btn" class="btn-round" data-tooltip="進入會議" disabled>{% include 'svg/right_arrow.svg' %}</button>
        </div>
    </div>
{% endblock content %}